!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof noAMDDefine&&noAMDDefine.amd?noAMDDefine(["exports"],e):e(t.IoC={})}(this,function(t){"use strict";function checkType(t){if(!t)throw new TypeError("Invalid type requested to IoC container. Type is not defined.")}function __extends$1(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}function AutoWired(t){var e=o.decorateConstructor(t);return u.bind(t).toConstructor(e),e}function InjectPropertyDecorator(t,e){var r=Reflect.getMetadata("design:type",t,e);r||(r=Reflect.getMetadata("design:type",t.constructor,e)),u.injectProperty(t.constructor,e,r)}function InjectParamDecorator(t,e,r){if(!e){var n=u.bind(t);n.paramTypes=n.paramTypes||[];var o=Reflect.getMetadata("design:paramtypes",t);n.paramTypes.unshift(o[r])}}var e,r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(t){!function(e){function makeExporter(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}var n="object"==typeof r?r:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=makeExporter(t);void 0===n.Reflect?n.Reflect=t:o=makeExporter(n.Reflect,o),function(t){function GetOrCreateMetadataMap(t,e,r){var n=d.get(t);if(IsUndefined(n)){if(!r)return;n=new f,d.set(t,n)}var o=n.get(e);if(IsUndefined(o)){if(!r)return;o=new f,n.set(e,o)}return o}function OrdinaryHasMetadata(t,e,r){if(OrdinaryHasOwnMetadata(t,e,r))return!0;var n=OrdinaryGetPrototypeOf(e);return!IsNull(n)&&OrdinaryHasMetadata(t,n,r)}function OrdinaryHasOwnMetadata(t,e,r){var n=GetOrCreateMetadataMap(e,r,!1);return!IsUndefined(n)&&function ToBoolean(t){return!!t}(n.has(t))}function OrdinaryGetMetadata(t,e,r){if(OrdinaryHasOwnMetadata(t,e,r))return OrdinaryGetOwnMetadata(t,e,r);var n=OrdinaryGetPrototypeOf(e);return IsNull(n)?void 0:OrdinaryGetMetadata(t,n,r)}function OrdinaryGetOwnMetadata(t,e,r){var n=GetOrCreateMetadataMap(e,r,!1);if(!IsUndefined(n))return n.get(t)}function OrdinaryDefineOwnMetadata(t,e,r,n){GetOrCreateMetadataMap(r,n,!0).set(t,e)}function OrdinaryMetadataKeys(t,e){var r=OrdinaryOwnMetadataKeys(t,e),n=OrdinaryGetPrototypeOf(t);if(null===n)return r;var o=OrdinaryMetadataKeys(n,e);if(o.length<=0)return r;if(r.length<=0)return o;for(var i=new y,a=[],s=0,c=r;s<c.length;s++){f=c[s];(d=i.has(f))||(i.add(f),a.push(f))}for(var u=0,p=o;u<p.length;u++){var f=p[u],d=i.has(f);d||(i.add(f),a.push(f))}return a}function OrdinaryOwnMetadataKeys(t,e){var r=[],n=GetOrCreateMetadataMap(t,e,!1);if(IsUndefined(n))return r;for(var i=function GetIterator(t){var e=GetMethod(t,o);if(!IsCallable(e))throw new TypeError;var r=e.call(t);if(!IsObject(r))throw new TypeError;return r}(n.keys()),a=0;;){var s=function IteratorStep(t){var e=t.next();return!e.done&&e}(i);if(!s)return r.length=a,r;var c=function IteratorValue(t){return t.value}(s);try{r[a]=c}catch(t){try{!function IteratorClose(t){var e=t.return;e&&e.call(t)}(i)}finally{throw t}}a++}}function Type(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function IsUndefined(t){return void 0===t}function IsNull(t){return null===t}function IsObject(t){return"object"==typeof t?null!==t:"function"==typeof t}function ToPropertyKey(t){var e=function ToPrimitive(t,e){switch(Type(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",o=GetMethod(t,n);if(void 0!==o){var i=o.call(t,r);if(IsObject(i))throw new TypeError;return i}return function OrdinaryToPrimitive(t,e){if("string"===e){var r=t.toString;if(IsCallable(r)){i=r.call(t);if(!IsObject(i))return i}n=t.valueOf;if(IsCallable(n)){i=n.call(t);if(!IsObject(i))return i}}else{var n=t.valueOf;if(IsCallable(n)){i=n.call(t);if(!IsObject(i))return i}var o=t.toString;if(IsCallable(o)){var i=o.call(t);if(!IsObject(i))return i}}throw new TypeError}(t,"default"===r?"number":r)}(t,3);return function IsSymbol(t){return"symbol"==typeof t}(e)?e:function ToString(t){return""+t}(e)}function IsArray(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function IsCallable(t){return"function"==typeof t}function IsConstructor(t){return"function"==typeof t}function GetMethod(t,e){var r=t[e];if(void 0!==r&&null!==r){if(!IsCallable(r))throw new TypeError;return r}}function OrdinaryGetPrototypeOf(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var o=n.constructor;return"function"!=typeof o?e:o===t?e:o}function MakeDictionary(t){return t.__=void 0,delete t.__,t}var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!i&&!a,c={create:i?function(){return MakeDictionary(Object.create(null))}:a?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:s?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:s?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),p="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=p||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function CreateMapPolyfill(){var t={},e=[],r=function(){function MapIterator(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return MapIterator.prototype["@@iterator"]=function(){return this},MapIterator.prototype[o]=function(){return this},MapIterator.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},MapIterator.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},MapIterator.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},MapIterator}();return function(){function Map(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Map.prototype.has=function(t){return this._find(t,!1)>=0},Map.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},Map.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},Map.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var n=this._keys.length,o=r+1;o<n;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},Map.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},Map.prototype.keys=function(){return new r(this._keys,this._values,function getKey(t,e){return t})},Map.prototype.values=function(){return new r(this._keys,this._values,function getValue(t,e){return e})},Map.prototype.entries=function(){return new r(this._keys,this._values,function getEntry(t,e){return[t,e]})},Map.prototype["@@iterator"]=function(){return this.entries()},Map.prototype[o]=function(){return this.entries()},Map.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},Map}()}():Map,y=p||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function CreateSetPolyfill(){return function(){function Set(){this._map=new f}return Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Set.prototype.has=function(t){return this._map.has(t)},Set.prototype.add=function(t){return this._map.set(t,t),this},Set.prototype.delete=function(t){return this._map.delete(t)},Set.prototype.clear=function(){this._map.clear()},Set.prototype.keys=function(){return this._map.keys()},Set.prototype.values=function(){return this._map.values()},Set.prototype.entries=function(){return this._map.entries()},Set.prototype["@@iterator"]=function(){return this.keys()},Set.prototype[o]=function(){return this.keys()},Set}()}():Set,d=new(p||"function"!=typeof WeakMap?function CreateWeakMapPolyfill(){function CreateUniqueKey(){var e;do{e="@@WeakMap@@"+function CreateUUID(){var e=function GenRandomBytes(t){if("function"==typeof Uint8Array)return"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):FillRandomBytes(new Uint8Array(t),t);return FillRandomBytes(new Array(t),t)}(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",n=0;n<t;++n){var o=e[n];4!==n&&6!==n&&8!==n||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}()}while(c.has(r,e));return r[e]=!0,e}function GetOrCreateWeakMapTable(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function FillRandomBytes(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}var t=16,r=c.create(),n=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}return WeakMap.prototype.has=function(t){var e=GetOrCreateWeakMapTable(t,!1);return void 0!==e&&c.has(e,this._key)},WeakMap.prototype.get=function(t){var e=GetOrCreateWeakMapTable(t,!1);return void 0!==e?c.get(e,this._key):void 0},WeakMap.prototype.set=function(t,e){return GetOrCreateWeakMapTable(t,!0)[this._key]=e,this},WeakMap.prototype.delete=function(t){var e=GetOrCreateWeakMapTable(t,!1);return void 0!==e&&delete e[this._key]},WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()},WeakMap}()}():WeakMap);t("decorate",function decorate(t,e,r,n){{if(IsUndefined(r)){if(!IsArray(t))throw new TypeError;if(!IsConstructor(e))throw new TypeError;return function DecorateConstructor(t,e){for(var r=t.length-1;r>=0;--r){var n=(0,t[r])(e);if(!IsUndefined(n)&&!IsNull(n)){if(!IsConstructor(n))throw new TypeError;e=n}}return e}(t,e)}if(!IsArray(t))throw new TypeError;if(!IsObject(e))throw new TypeError;if(!IsObject(n)&&!IsUndefined(n)&&!IsNull(n))throw new TypeError;return IsNull(n)&&(n=void 0),r=ToPropertyKey(r),function DecorateProperty(t,e,r,n){for(var o=t.length-1;o>=0;--o){var i=(0,t[o])(e,r,n);if(!IsUndefined(i)&&!IsNull(i)){if(!IsObject(i))throw new TypeError;n=i}}return n}(t,e,r,n)}});t("metadata",function metadata(t,e){return function decorator(r,n){if(!IsObject(r))throw new TypeError;if(!IsUndefined(n)&&!function IsPropertyKey(t){switch(Type(t)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;OrdinaryDefineOwnMetadata(t,e,r,n)}});t("defineMetadata",function defineMetadata(t,e,r,n){if(!IsObject(r))throw new TypeError;IsUndefined(n)||(n=ToPropertyKey(n));return OrdinaryDefineOwnMetadata(t,e,r,n)});t("hasMetadata",function hasMetadata(t,e,r){if(!IsObject(e))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));return OrdinaryHasMetadata(t,e,r)});t("hasOwnMetadata",function hasOwnMetadata(t,e,r){if(!IsObject(e))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));return OrdinaryHasOwnMetadata(t,e,r)});t("getMetadata",function getMetadata(t,e,r){if(!IsObject(e))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));return OrdinaryGetMetadata(t,e,r)});t("getOwnMetadata",function getOwnMetadata(t,e,r){if(!IsObject(e))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));return OrdinaryGetOwnMetadata(t,e,r)});t("getMetadataKeys",function getMetadataKeys(t,e){if(!IsObject(t))throw new TypeError;IsUndefined(e)||(e=ToPropertyKey(e));return OrdinaryMetadataKeys(t,e)});t("getOwnMetadataKeys",function getOwnMetadataKeys(t,e){if(!IsObject(t))throw new TypeError;IsUndefined(e)||(e=ToPropertyKey(e));return OrdinaryOwnMetadataKeys(t,e)});t("deleteMetadata",function deleteMetadata(t,e,r){if(!IsObject(e))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));var n=GetOrCreateMetadataMap(e,r,!1);if(IsUndefined(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var o=d.get(e);return o.delete(r),o.size>0||(d.delete(e),!0)})}(o)}()}(e||(e={}));var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},o=function(){function InjectorHandler(){}return InjectorHandler.decorateConstructor=function(t){var e;return e=function(e){function ioc_wrapper(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=e.apply(this,r)||this;return u.assertInstantiable(t),o}return __extends$1(ioc_wrapper,e),ioc_wrapper}(t),e.__parent=t,e},InjectorHandler.getConstructorFromType=function(t){var e=t;if(e.name&&"ioc_wrapper"!==e.name)return e;for(;e=e.__parent;)if(e.name&&"ioc_wrapper"!==e.name)return e;throw TypeError("Can not identify the base Type for requested target")},InjectorHandler}(),i=function(){function Scope(){}return Scope.prototype.reset=function(t){},Scope}(),a=function(t){function LocalScope(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(LocalScope,t),LocalScope.prototype.resolve=function(t,e){return t.get()},LocalScope}(i);i.Local=new a;var s=function(t){function SingletonScope(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SingletonScope,t),SingletonScope.prototype.resolve=function(t,e){var r=SingletonScope.instances.get(e);return r||(e.__block_Instantiation=!1,r=t.get(),e.__block_Instantiation=!0,SingletonScope.instances.set(e,r)),r},SingletonScope.prototype.reset=function(t){SingletonScope.instances.delete(o.getConstructorFromType(t))},SingletonScope.instances=new Map,SingletonScope}(i);i.Singleton=new s;var c=function(){function ConfigImpl(t){this.source=t}return ConfigImpl.prototype.getInstance=function(){return this.iocscope||this.scope(i.Local),this.iocscope.resolve(this.iocprovider,this.source)},ConfigImpl.prototype.provider=function(t){return this.iocprovider=t,this.iocscope&&this.iocscope.reset(this.source),this},ConfigImpl.prototype.scope=function(t){return this.iocscope=t,t===i.Singleton?(this.source.__block_Instantiation=!0,t.reset(this.source)):this.source.__block_Instantiation&&delete this.source.__block_Instantiation,this},ConfigImpl.prototype.to=function(t){checkType(t);var e=o.getConstructorFromType(t);if(this.source===e){var r=this;this.iocprovider={get:function(){var e=r.getParameters();return r.decoratedConstructor?e?new((n=r.decoratedConstructor).bind.apply(n,[void 0].concat(e))):new r.decoratedConstructor:e?new(t.bind.apply(t,[void 0].concat(e))):new t;var n}}}else this.iocprovider={get:function(){return u.get(t)}};return this.iocscope&&this.iocscope.reset(this.source),this},ConfigImpl.prototype.toConstructor=function(t){return this.decoratedConstructor=t,this},ConfigImpl.prototype.withParams=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.paramTypes=t,this},ConfigImpl.prototype.getParameters=function(){return this.paramTypes?this.paramTypes.map(function(t){return u.get(t)}):null},ConfigImpl}(),u=function(){function IoCContainer(){}return IoCContainer.assertInstantiable=function(t){if(t.__block_Instantiation)throw new TypeError("Can not instantiate Singleton class. Ask Container for it, using Container.get")},IoCContainer.bind=function(t){checkType(t);var e=o.getConstructorFromType(t),r=IoCContainer.bindings.get(e);return r||(r=new c(e),IoCContainer.bindings.set(e,r)),r},IoCContainer.get=function(t){var e=IoCContainer.bind(t);return e.iocprovider||e.to(e.source),e.getInstance()},IoCContainer.injectProperty=function(t,e,r){var n="__"+e;Object.defineProperty(t.prototype,e,{enumerable:!0,get:function(){return this[n]?this[n]:this[n]=IoCContainer.get(r)},set:function(t){this[n]=t}})},IoCContainer.isBound=function(t){checkType(t);var e=o.getConstructorFromType(t);return!!IoCContainer.bindings.get(e)},IoCContainer.bindings=new Map,IoCContainer}(),p=function(){function Container(){}return Container.bind=function(t){return u.isBound(t)?u.bind(t):(AutoWired(t),u.bind(t).to(t))},Container.get=function(t){return u.get(t)},Container.restore=function(t){if(!Container.snapshots.providers.has(t))throw new TypeError("Config for source was never snapshoted.");var e=Container.bind(t),r=Container.snapshots.providers.get(t),n=Container.snapshots.scopes.get(t);r&&e.provider(r),n&&e.scope(n)},Container.snapshot=function(t){var e=Container.bind(t);Container.snapshots.providers.set(t,e.iocprovider),e.iocscope&&Container.snapshots.scopes.set(t,e.iocscope)},Container.snapshots={providers:new Map,scopes:new Map},Container}();t.AutoWired=AutoWired,t.ConfigImpl=c,t.Container=p,t.Inject=function Inject(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length<3||void 0===t[2])return InjectPropertyDecorator.apply(this,t);if(3===t.length&&"number"==typeof t[2])return InjectParamDecorator.apply(this,t);throw new Error("Invalid @Inject Decorator declaration.")},t.InjectorHandler=o,t.InjectParamDecorator=InjectParamDecorator,t.InjectPropertyDecorator=InjectPropertyDecorator,t.IoCContainer=u,t.Provided=function Provided(t){return function(e){u.bind(e).provider(t)}},t.Provides=function Provides(t){return function(e){u.bind(t).to(e)}},t.Scope=i,t.Scoped=function Scoped(t){return function(e){u.bind(e).scope(t)}},t.Singleton=function Singleton(t){u.bind(t).scope(i.Singleton)},Object.defineProperty(t,"__esModule",{value:!0})});
